"use strict";angular.module("sw.plugin.swagger1to2",["sw.plugins"]).factory("swagger1to2",["$q","$http","plugins",function(e,s,t){function r(r){var n=e.defer(),o={method:"GET",url:r};return t.execute(t.BEFORE_LOAD,o).then(function(){s(o).success(n.resolve).error(n.reject)})["catch"](n.reject),n.promise}function n(s,t,n){var i=n,c=i.info=i.info||{},f=[];c.contact={email:c.contact},c.license={name:c.license,url:c.licenseUrl},c.termsOfService=c.termsOfServiceUrl,i.paths={},i.definitions={},i.tags=[],angular.forEach(i.apis,function(e){f.push(r(t+e.path))}),e.all(f).then(function(e){angular.forEach(e,function(e){o(e,i),a(e,i),p(e,i)}),i.swagger="2.0",s.resolve(!0)})["catch"](s.reject)}function o(e,s){if(s.info.version=s.info.version||e.apiVersion,s.basePath=s.basePath||e.basePath,0===s.basePath.indexOf("http")){var t=angular.element('<a href="'+s.basePath+'"></a>')[0];s.schemes=[t.protocol.replace(":","")],s.host=t.host,s.basePath=t.pathname}s.info.title=s.info.title||s.host,s.tags.push({name:e.resourcePath})}function a(e,s){var t,r;angular.forEach(e.apis,function(n){t=s.paths[n.path]=s.paths[n.path]||{},angular.forEach(n.operations,function(s){r={},t[s.method.toLowerCase()]={deprecated:s.deprecated,description:s.notes,summary:s.summary,operationId:s.nickname,produces:s.produces||e.produces,consumes:s.consumes||e.consumes,parameters:s.parameters,responses:r,tags:[e.resourcePath]},i(e,s),c(e,s,r)})})}function i(e,s){angular.forEach(s.parameters,function(s){s["in"]=s.paramType;var t=s.type||s.$ref;e.models&&t&&e.models[t]&&(s.schema={$ref:"#/definitions/"+t},delete s.type)})}function c(e,s,t){var r;angular.forEach(s.responseMessages,function(n){if(r=t[n.code]={description:n.message},n.responseModel)e.models&&e.models[n.responseModel]?r.schema={$ref:"#/definitions/"+n.responseModel}:r.type=n.responseModel;else if(200===n.code&&"void"!==s.type&&(e.models&&e.models[s.type]?r.schema={type:s.type,$ref:"#/definitions/"+s.type}:r.schema={type:s.type},"array"===s.type)){var o=s.items.type||s.items.$ref,a=r.schema.items={};e.models&&e.models[o]?a.$ref="#/definitions/"+o:a.type=o}})}function p(e,s){var t;angular.forEach(e.models,function(r,n){s.definitions[n]=r,r.subTypes&&(angular.forEach(r.subTypes,function(s){t=e.models&&e.models[s],t&&(r.required=(r.required||[]).concat(t.required||[]),angular.forEach(t.properties,function(e,s){r.properties[s]=e}))}),delete r.subTypes),angular.forEach(r.properties,function(s){var t=s.type||s.$ref;e.models&&t&&e.models[t]&&(s.$ref="#/definitions/"+t,delete s.type),s.items&&(t=s.items.type||s.items.$ref,e.models&&t&&e.models[t]&&(s.items.$ref="#/definitions/"+t),delete s.items.type)})})}return{execute:function(s,t){var r=e.defer(),o=t.swaggerVersion;return o&&0===o.indexOf("1.")?n(r,s,t):r.resolve(!1),r.promise}}}]).run(["plugins","swagger1to2",function(e,s){e.add(e.BEFORE_PARSE,s)}]);