"use strict";angular.module("sw.plugin.externalReferences",["sw.plugins"]).factory("externalReferences",["$http","$q","$window","plugins",function(e,n,r,t){function a(e){c.reject(e)}function u(n,r){var u={method:"GET",url:n};t.execute(t.BEFORE_LOAD,u).then(function(){e(u).then(r,a)})["catch"](a)}function i(e,n){if(!angular.isString(n))return"";var t=n.split("#/"),a=t[0];if(a&&0!==a.indexOf("http"))if(0===a.indexOf("/")){var u=r.URL.parse(e);a=u.protocol+"//"+u.host+a}else{var i=e.lastIndexOf("/");a=e.substring(0,i)+"/"+a}return a}function f(e,n){function r(e,n){a++,u(e,function(e){a--;var r=n.$ref.split("#/")[1],t=r?e.data[r]:e.data;angular.extend(n,t),delete n.$ref,0===a&&c.resolve(!0)})}function t(n){angular.forEach(n,function(a,u){if("$ref"===u){var f=i(e,a);f&&r(f,n)}else(angular.isObject(a)||angular.isArray(a))&&t(a)})}var a=0;t(n),a||c.resolve(!1)}var c;return{execute:function(e,r){return c=n.defer(),f(e,r),c.promise}}}]).run(["plugins","externalReferences",function(e,n){e.add(e.BEFORE_PARSE,n)}]);